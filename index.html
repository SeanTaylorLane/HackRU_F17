<!DOCTYPE html>
<html>
  <head>
    <title>eventLab</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link type="text/css" rel="stylesheet" href="style.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
    <script type="text/javascript" src="http://static.fusioncharts.com/code/latest/fusioncharts.js"></script>
    <script type="text/javascript" src="http://static.fusioncharts.com/code/latest/themes/fusioncharts.theme.fint.js?cacheBust=56"></script>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.41.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.41.0/mapbox-gl.css' rel='stylesheet' />
    <script
        src="https://code.jquery.com/jquery-3.2.1.js"
        integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
        crossorigin="anonymous"></script>
        <script src='excelexportjs.js'></script>
    <style>
        body { margin:0; padding:0; }
        #map { width:100%; height: 500px;}
    </style>
    <script type="text/javascript">
    

  FusionCharts.ready(function(){
    var pieAverageLeaveChart = new FusionCharts({
    type: 'pie2d',
    renderAt: 'pieAverageLeave-chart-container',
    width: '100%',
    height: '400',
    dataFormat: 'jsonurl',
    dataSource: 'https://hackru-5d3f1.firebaseio.com/Graphs/FusionChart/pieAverageLeave_graph.json'
//    dataSource: 'http://localhost:8000/pieAverageLeave_graph.json'
    
});
      
    var pieRetentionChart = new FusionCharts({
    type: 'pie2d',
    renderAt: 'pieRetention-chart-container',
    width: '100%',
    height: '400',
    dataFormat: 'jsonurl',
    dataSource: 'https://hackru-5d3f1.firebaseio.com/Graphs/FusionChart/pieRetention_graph.json'
//    dataSource: 'http://localhost:8000/pieRetention_graph.json'
    
});
    
    var attendanceChart = new FusionCharts({
    type: 'area2d',
    renderAt: 'attendance-chart-container',
    width: '100%',
    height: '400',
    dataFormat: 'jsonurl',
    dataSource: 'https://hackru-5d3f1.firebaseio.com/Graphs/FusionChart/attendance_graph.json'
//    dataSource: 'http://localhost:8000/attendance_graph.json'
    
});
    var leaveChart = new FusionCharts({
      type: 'msarea',
      renderAt: 'leave-chart-container',
      width: '100%',
      height: '400',
      dataFormat: 'jsonurl',
      dataSource: 'https://hackru-5d3f1.firebaseio.com/Graphs/FusionChart/leave_graph.json'
//      dataSource: 'http://localhost:8000/leave_graph.json'
    });
    
    pieAverageLeaveChart.render();
    pieRetentionChart.render();
    attendanceChart.render();
    leaveChart.render();
});
</script>
  </head>
  <body>
    
    <div id="menu-modal">
      <ul>
        <li>Attendees</li>
        <li>Analytics</li>
      </ul>
    </div>
    
    <!-- MENU/USERPIC -->
    <div class="row" style="margin-top: 40px;">
      <div class="col-1">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </div>
      <div class="col-10"></div>
      <div class="col-1">
        <i class="fa fa-user-circle" aria-hidden="true"></i>
      </div>
    </div>
    
    <!-- HACKRU TITLE -->
    <div class="row">
      <div class="col-3"></div>
      <div class="col-6"><h1>Analysis</h1></div>
      <div class="col-3"></div>
    </div>

    <div class="row">
      <div class="col-4"></div>
      <div class="col-4">
        <p class="info">HackRU Fall 2017</p>
<!--        <p class="info">College Avenue Student Center</p>-->
      </div>
      <div class="col-4"></div>
    </div>
      
       
    <!-- ATTENDANCE CHART -->
    <div class="row" style="margin-top: 70px;">
      <div class="col-2"></div>
      <div class="col-8">
        <div id="attendance-chart-container">FusionCharts XT will load here!</div>
      </div>
      <div class="col-2"></div>
    </div>
    
    <!-- EXPORT BUTTON -->
    <div class="row" style="margin-top: 70px;">
      <div class="col-5"></div>
      <div class="col-2">
        <button id="export">Export Contact Info</button>
      </div>
      <div class="col-5"></div>
    </div>
    
    <!-- PIE CHARTS-->
    <div class="row" style="margin-top: 80px;">
      <div class="col-2"></div>
      <div class="col-4">
        <div id="pieRetention-chart-container">FusionCharts XT will load here!</div>
      </div>
      <div class="col-4">
          <div id="pieAverageLeave-chart-container">FusionCharts XT will load here!</div>
      </div>
      <div class="col-2"></div>
    </div>
    
    <!-- LEAVE CHART -->
    <div class="row" style="margin-top: 80px;">
      <div class="col-2"></div>
      <div class="col-8">
        <div id="leave-chart-container">FusionCharts XT will load here!</div>
      </div>
      <div class="col-2"></div>
    </div>
    
    <!-- HEATMAP HEADER -->
    <div class="row" style="margin-top: 80px;">
      <div class="col-12">
        <h2>Activity Heatmap</h2>
      </div>
    </div>
    
    <!-- HEATMAP -->
    <div class="row">
      <div class="col-2"></div>
      <div class="col-8">
        <div id="map"></div>
      </div>
      <div class="col-2"></div>
    </div>
    
    <script>
      mapboxgl.accessToken = 'pk.eyJ1Ijoic2VhbmxhbmUiLCJhIjoiY2o4cm5hcXY2MThhdTMycGM3d3o3ZmR1ZSJ9.Ra9k4o_ghglPjP6u0OlPhA';
      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/light-v9',
          center: [-74.452423, 40.502634],
          zoom: 19.2
      });

//      var url = 'http://localhost:8000/locations.json';
      var url = 'https://hackru-5d3f1.firebaseio.com/Graphs/Heatmap.json';
      map.on('load', function () {
          window.setInterval(function() {
              map.getSource('locations').setData(url);
          }, 500);

          map.addSource('locations', { type: 'geojson', data: url });
          map.addLayer({
              "id": "locations-heatmap",
              "type": "heatmap",
              "source": "locations",
              "paint": {
                  "heatmap-color": {
                      "stops": [
                          [0, "rgba(33,102,172,0)"],
                          [0.2, "rgb(103,169,207)"],
                          [0.4, "rgb(209,229,240)"],
                          [0.6, "rgb(253,219,199)"],
                          [0.8, "rgb(239,138,98)"],
                          [1, "rgb(178,24,43)"]
                      ]
                  }
              }
              }
          );
      });
      
      //assuming you have a json data as above
	var data = [
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},
      {"Name":"Peter Jones", "eMail":"mymom@microsoft.com"},
      {"Name":"John Doe", "eMail":"coolguy@gmail.com"}, 
      {"Name":"Anna Smith", "eMail":"urmom@hotmail.com"},      
      {"Name":"Salman Fakhri", "eMail":"salmanfakhri2@gmail.com"}      
      
				]
					
	
	var $btnexport = $('#export');
    $btnexport.on('click', function () {
      	$("#dvjson").excelexportjs({
                    containerid: "dvjson"
                       , datatype: 'json'
                       , dataset: data
                       , columns: getColumns(data)     
                });

    });
    </script>
  </body>
</html>